02-AndroidBuildSystem - Android Build System in Detail
==============================================================
Android build system works on 3 different build tools such as soong, ninja and make. 

.. figure:: AndroidBuildSystemE.png
   :scale: 100 %

Soong
-----------
In the soong build system, the rules of compiling is defined in ".bp" or Blueprint file which 
is similar to JSON format.

A module in an Android.bp file starts with a module type, followed by a set of properties 
in name: value, format:

.. code-block:: shell

    cc_binary {
        name: "test",
        srcs: ["src/test/test.c"],
        shared_libs: ["libz"],
        stl: "none",
    }

Blueprint files are then processed by a tool called Blueprint which produces ".ninja" files 
which consists of rules for compiling Android Software Modules. ".ninja" is used by Ninja 
tool which compiles and generates output binaries.

Make
-----------
Make is a tool that controls the build, while calculating dependancies, include files using 
Makefile. It uses Makefile and ".mk" to control the build. It is one of the widely used build 
system tool. Some of the packages such as kernel uses Make for its build.

Example Makefile Format:

.. code-block:: Makefile

    LOCAL_PATH := $(call my-dir)
    include $(CLEAR_VARS)

    LOCAL_SRC_FILES = helloworld.c
    LOCAL_MODULE = helloworld
    LOCAL_MODULE_TAGS = optional

    include $(BUILD_EXECUTABLE)

Makefile had several shortcomings including low performance and was replaced by Soong Build System 
in most of the modules.

Kati tool converts all ".mk" files into ".ninja" files.

Ninja
-----------
Ninja is a small build system with a focus on speed. It differs from other build systems in two 
major respects: it is designed to have its input files generated by a higher-level build system, 
and it is designed to run builds as fast as possible. While most of the build systems are high-level 
languages Ninja aims to be an assembler. Ninja build files are human-readable but not especially 
convenient to write by hand. Other build systems take time in building and calculating dependancies. 
Ninja uses control files which uses minimum parsing to acheive maximum execution speed.




 
