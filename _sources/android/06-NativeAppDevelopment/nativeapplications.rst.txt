06-NativeAppDevelopment - Native Applications
==================================================
This chapter covers the steps to create a native application in AOSP and have it prebuilt.

Steps
----------
1. mkdir <AOSP>/hardware/testservice
2. cd <AOSP>/hardware/testservice
3. vi testservice.cpp

.. code-block:: c++

    #include <cstdlib>
    #include <string>
    #include <log/log.h>

    #undef LOG_TAG
    #define LOG_TAG "testservice"

    int main(int argc __unused, char **argv __unused) {
        ALOGI("TestService");
        return EXIT_SUCCESS;
    }

4. vi Android.mk and add following Lines

.. code-block:: Makefile

    LOCAL_PATH := $(call my-dir)
    include $(CLEAR_VARS)
    LOCAL_SRC_FILES := testservice.cpp
    LOCAL_MODULE := testservice
    LOCAL_MODULE_TAGS := debug
    LOCAL_SYSTEM_SHARED_LIBRARIES := libc
    LOCAL_SHARED_LIBRARIES := libutils liblog
    include $(BUILD_EXECUTABLE)
    
5. Append the following lines in init.rc or add this under service owned rc file

.. code-block::

    service exampleservice /system/bin/testservice
        user testservice
        group testservice
        oneshot

6. Append the following line in manufacturer/device-name/sepolicy/file_contexts:

.. code-block::

    /vendor/bin/testservice u:object_r:testservice_exec:s0






