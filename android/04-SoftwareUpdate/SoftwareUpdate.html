<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flashing Android &mdash; Easwarnet  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="BootAndPartitions" href="../05-BootAndPartitions/BootAndPartitions.html" />
    <link rel="prev" title="AndroidTools" href="../03-AndroidTools/AndroidTools.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Easwarnet
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">C++</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-smartptr.html">C++ - Smart Pointer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-inheritence.html">C++ - Inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-container.html">C++ - Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-stdlib.html">C++ - StdLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-general.html">C++ - General</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AOSP Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../aosp-general.html">AOSP - General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aosp-haltheory.html">AOSP - Theory of HAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aosp-ipc.html">AOSP - IPC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../linux-posix.html">Linux - Posix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linux-commands.html">Linux - Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../os-general.html">Os - General Concepts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AOSP Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../01-Introduction/Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-AndroidBuildSystem/AndroidBuildSystem.html">AndroidBuildSystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-AndroidTools/AndroidTools.html">AndroidTools</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Flashing Android</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1"><strong>Flashing Android</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#useful-commands-for-flashing-android">Useful Commands for Flashing Android:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference">Reference:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ota"><strong>OTA</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-is-a-b-seamless-update">What is A/B seamless update?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#benefits">Benefits</a></li>
<li class="toctree-l2"><a class="reference internal" href="#recovery-partition">Recovery Partition</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../05-BootAndPartitions/BootAndPartitions.html">BootAndPartitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06-NativeAppDevelopment/NativeAppDevelopment.html">NativeAppDevelopment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07-AndroidIPC/AndroidIPC.html">AndroidIPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-AppCoreComponents/AppCoreComponents.html">AppCoreComponents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09-TestFramework/TestFramework.html">TestFramework</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Embedded Beginner</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../os-rtos.html">Os - RTOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-pointers.html">C - Pointers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-funcpointers.html">C - Function Pointers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-general.html">C - General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-basicalgo.html">C - Basic Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-tricks.html">C - Tricks and Others</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Easwarnet</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Flashing Android</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="flashing-android">
<h1>Flashing Android<a class="headerlink" href="#flashing-android" title="Permalink to this heading"></a></h1>
<section id="id1">
<h2><strong>Flashing Android</strong><a class="headerlink" href="#id1" title="Permalink to this heading"></a></h2>
<p>Android uses a tool called Fastboot for flashing all partitions. Fastboot uses fastboot protocol to communicate with an Android device. Fastboot mode is a part of Android and flashing partitions is possibles through this mode.</p>
</section>
<section id="useful-commands-for-flashing-android">
<h2>Useful Commands for Flashing Android:<a class="headerlink" href="#useful-commands-for-flashing-android" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Check List of Connected Devices:</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ adb devices
</pre></div>
</div>
<p>2. Boot into bootloader mode:
This step will enable the device boot into fastboot mode.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ adb reboot bootloader
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Check connected devices in Fastboot mode:</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ fastboot devices
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Boot into ROM:</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ fastboot reboot
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Boot into recovery:</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ fastboot reboot recovery
</pre></div>
</div>
<p>6. Flash All
This steps is used for flashing a custom ROM that is available in the form of a ZIP file containing all the image files:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ fastboot update &lt;zip_containing_all_androidimages&gt;.zip
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Flash Specific Image:</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># Flashing Boot Image</span>
$ fastboot flash boot boot.img
<span class="c1"># Flashing System Image</span>
$ fastboot flash system system.img
</pre></div>
</div>
<ol class="arabic simple" start="8">
<li><p>Unlocking Partition:</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check OEM Specific Boot Partition Lock Status</span>
$ fastboot oem device-info
<span class="c1"># Unlock OEM Specific Boot Partition</span>
$ fastboot oem unlock
<span class="c1"># Unlocking all partitions</span>
$ fastboot flashing unlock
<span class="c1"># Unlock Boot Partition</span>
$ fastboot flashing unlock_critical
</pre></div>
</div>
<p>9. Erase or Format Partition:
Format Userdata Partition</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ fastboot format:ext4 userdata
</pre></div>
</div>
</section>
<section id="reference">
<h2>Reference:<a class="headerlink" href="#reference" title="Permalink to this heading"></a></h2>
<p>[1]: <code class="docutils literal notranslate"><span class="pre">https://forum.xda-developers.com/t/adb-fastboot-linux-commands-bootloader-kernel-recovery-rom-root-backup.3597181/</span></code></p>
<p>[2]: <code class="docutils literal notranslate"><span class="pre">https://android.googlesource.com/platform/system/core/+/refs/tags/android-9.0.0_r34/fastboot/fastboot.cpp#331</span></code></p>
</section>
<hr class="docutils" />
<section id="ota">
<h2><strong>OTA</strong><a class="headerlink" href="#ota" title="Permalink to this heading"></a></h2>
<p>Android devices use GPT. The GUID Partition Table (GPT) is a standard for the layout of partition tables of a physical computer storage device. GUID Partition Table (GPT) was introduced with UEFI booting system which isn’t dependent on first boot sector and hence may contain up to 128 partitions. One of the features Android offers is A/B Seamless Update</p>
</section>
<section id="what-is-a-b-seamless-update">
<h2>What is A/B seamless update?<a class="headerlink" href="#what-is-a-b-seamless-update" title="Permalink to this heading"></a></h2>
<figure class="align-default">
<a class="reference internal image-reference" href="../../_images/seamlessupdate.png"><img alt="../../_images/seamlessupdate.png" src="../../_images/seamlessupdate.png" style="width: 926.0px; height: 240.0px;" /></a>
</figure>
<p>A/B system updates, also known as seamless updates, ensures a bootable system and minimum downtime when performing a OTA update.</p>
<p>Seamless updates work by having two different system partitions on a device. When using a device that can perform seamless updates, while one system partition is running, the second partition is updated in parallel. Once this is done, the system reboots and starts to use the newly updatd partition, while the last partition that was used just before reboot will be used as a partition for next update. A configuration memory points to the memory region of the newly updated partition. When the system boots, this configuration memory is read by the bootloader and boots the newly updated memory. The next upgrade process will update the other system partition. They swap back and forth seamlessly.</p>
<p>A/B system updates, also known as seamless updates, ensures a boot able system and minimum downtime when performing a OTA update.</p>
<p>Seamless updates work by having two different system partitions on a device. When using a device that can perform seamless updates, all the transferring is done while one system partition is running, as things are copied and moved into the second partition. Once all this is done, you can reboot and use the new system partition. This is done without moving the partitions or renaming them because they are numbered. A configuration file used during the boot process is read that tells the kernel and boot process where each partition starts and stops. This file is changed to point to the new system partition instead of the current one(becomes inactive). The next time you update, the other system partition will be wiped and used. They swap back and forth seamlessly.</p>
<ul class="simple">
<li><p>We start with two system partitions, system_a and system_b, both on the same version of Android.</p></li>
<li><p>Assuming that system_a is active, the OTA update will patch system_b, the inactive partition, in the background.</p></li>
<li><p>system_a is set to inactive and system_b then becomes active once the user reboots.</p></li>
<li><p>The now-inactive partition, system_a, will be updated when the next OTA update rolls out.</p></li>
</ul>
</section>
<section id="benefits">
<h2>Benefits<a class="headerlink" href="#benefits" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>If an update fails, the device will roll back to the working build on the other slot.</p></li>
<li><p>Your data is kept perfectly intact, even if the update is borked, as there is only one partition (userdata) which houses your data.</p></li>
<li><p>Update streaming: If your data partition is full, then the update can be downloaded and streamed to the inactive slot. It’s a pretty neat feature and means that you don’t have to waste any temporary storage on your updates. That’s why there’s no cache partition on A/B devices as they’re no longer needed.</p></li>
</ul>
</section>
<section id="recovery-partition">
<h2>Recovery Partition<a class="headerlink" href="#recovery-partition" title="Permalink to this heading"></a></h2>
<p>The underlying Linux kernel on Android devices is what lets Android recognize and use the hardware properly on a smartphone. On A-only Android devices, you generally have two versions of the kernel: One is packed inside of the recovery partition while the other is in the boot partition. On A/B devices supporting seamless updates, the recovery is now inside of the boot image along with the kernel. The recovery’s main function was to install updates, but since that’s handled by the system itself (update_engine) while Android is booted up the dedicated recovery partition is no longer needed.</p>
<p>To install a custom recovery on A/B devices, we thus need to modify the boot partition and replace the stock recovery with our own. This is why to install TWRP you need to use a fastboot command to boot a custom boot image first and then flash the TWRP installation script, as fastboot can’t patch partitions—only flash over them entirely. You could technically pre-patch your existing boot image with TWRP and then flash it via fastboot, but that’s more trouble than it’s worth. The TWRP installer script patches both the boot_a and boot_b partitions to install TWRP.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../03-AndroidTools/AndroidTools.html" class="btn btn-neutral float-left" title="AndroidTools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../05-BootAndPartitions/BootAndPartitions.html" class="btn btn-neutral float-right" title="BootAndPartitions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Easwarnet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>