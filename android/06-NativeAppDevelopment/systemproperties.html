<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>06-NativeAppDevelopment - System Properties &mdash; Easwarnet  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="06-NativeAppDevelopment - Hardware Abstraction Layer" href="hal.html" />
    <link rel="prev" title="06-NativeAppDevelopment - System Services" href="systemservices.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Easwarnet
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">C++</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-smartptr.html">C++ - Smart Pointer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-inheritence.html">C++ - Inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-container.html">C++ - Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-stdlib.html">C++ - StdLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-general.html">C++ - General</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../linux-posix.html">Linux - Posix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linux-commands.html">Linux - Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../os-general.html">Os - General Concepts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AOSP</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../01-Introduction/androidarchitecture.html">01-Introduction - Android Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-Introduction/features.html">01-Introduction - Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-Introduction/hardwarecompatibility.html">01-Introduction - Hardware Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-Introduction/characteristics.html">01-Introduction - Characteristics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-AndroidBuildSystem/aospoverview.html">02-AndroidBuildSystem - AOSP Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-AndroidBuildSystem/downloadaosp.html">02-AndroidBuildSystem - Download AOSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-AndroidBuildSystem/androidbuildsystem.html">02-AndroidBuildSystem - Android Build System in Detail</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-AndroidBuildSystem/buildingandroid.html">02-AndroidBuildSystem - Building Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-AndroidTools/adb.html">03-AndroidTools - ADB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-AndroidTools/fastboot.html">03-AndroidTools - Fastboot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-AndroidTools/othertools.html">03-AndroidTools - Other Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04-SoftwareUpdate/flashingandroid.html">04-SoftwareUpdate - Flashing Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04-SoftwareUpdate/ota.html">04-SoftwareUpdate - OTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-BootAndPartitions/bootsequence.html">05-BootAndPartitions - Boot Sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-BootAndPartitions/partitions.html">05-BootAndPartitions - Partitions in Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-BootAndPartitions/secureboot.html">05-BootAndPartitions - Secure Boot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-BootAndPartitions/treble.html">05-BootAndPartitions - Project Treble</a></li>
<li class="toctree-l1"><a class="reference internal" href="initrc.html">06-NativeAppDevelopment - Init RC</a></li>
<li class="toctree-l1"><a class="reference internal" href="selinux.html">06-NativeAppDevelopment - SELinux</a></li>
<li class="toctree-l1"><a class="reference internal" href="nativeapplications.html">06-NativeAppDevelopment - Native Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="ndk.html">06-NativeAppDevelopment - NDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="systemservices.html">06-NativeAppDevelopment - System Services</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">06-NativeAppDevelopment - System Properties</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#command-line">Command Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-time-access-of-system-property">Run Time Access of System Property</a></li>
<li class="toctree-l2"><a class="reference internal" href="#predefined">Predefined</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference">Reference:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hal.html">06-NativeAppDevelopment - Hardware Abstraction Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="vhal.html">06-NativeAppDevelopment - VHAL - Vehicle HAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="vndk.html">06-NativeAppDevelopment - Vendor Native Development Kit (VNDK)</a></li>
<li class="toctree-l1"><a class="reference internal" href="loggingdebugging.html">06-NativeAppDevelopment - Logging and Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07-AndroidIPC/binder.html">07-AndroidIPC - Binder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07-AndroidIPC/hidl.html">07-AndroidIPC - HIDL - HAL Interface Descriptive Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07-AndroidIPC/aidl.html">07-AndroidIPC - Android Interface Definition Language (AIDL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-AppCoreComponents/activities.html">08-AppCoreComponents - Activities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-AppCoreComponents/services.html">08-AppCoreComponents - Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-AppCoreComponents/broadcast.html">08-AppCoreComponents - Broadcast Receivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-AppCoreComponents/contentproviders.html">08-AppCoreComponents - Content Providers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09-TestFramework/cts.html">09-TestFramework - Android CTS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09-TestFramework/vts.html">09-TestFramework - Android VTS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Embedded Beginner</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../os-rtos.html">Os - RTOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-pointers.html">C - Pointers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-funcpointers.html">C - Function Pointers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-general.html">C - General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-basicalgo.html">C - Basic Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-tricks.html">C - Tricks and Others</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../profile.html"><strong>About</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../profile.html#coming-soon">Coming Soon</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Easwarnet</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>06-NativeAppDevelopment - System Properties</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nativeappdevelopment-system-properties">
<h1>06-NativeAppDevelopment - System Properties<a class="headerlink" href="#nativeappdevelopment-system-properties" title="Permalink to this heading"></a></h1>
<p>System properties are a way to share global data across OS. Each partition can use its own system properties internally. System properties start with a prefix, which can be ro for properties only set once, or persist for properties that should still exist after a reboot. The properties can be set read-only or writable, or the values can be rolled back.</p>
<p>Some Examples of Android’s System Property</p>
<p><strong>ro.build.id</strong></p>
<p>Gives the build number of the current Android Os running in device</p>
<p><strong>ro.build.type</strong></p>
<p>Gives the type of build the device has currently running such as Engineering Debug, Engineering Build, Release</p>
<section id="command-line">
<h2>Command Line<a class="headerlink" href="#command-line" title="Permalink to this heading"></a></h2>
<p>A system property can be created, set and read using command line. However it is not persistent and needs to be set again after reboot, unless it is automatically created using init rc script.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1">### Create a property</span>
adb_shell# setprop propertykey propertyvalue

<span class="c1">### Get a Property</span>
adb_shell# getprop propertykey
</pre></div>
</div>
</section>
<section id="run-time-access-of-system-property">
<h2>Run Time Access of System Property<a class="headerlink" href="#run-time-access-of-system-property" title="Permalink to this heading"></a></h2>
<p>A property can be accessed by a program during Android Runtime. Below is the Cpp example on how System Properties can be accessed during Runtime.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">propertyvalue</span><span class="p">;</span>
<span class="n">System</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s">&quot;propertykey&quot;</span><span class="p">,</span> <span class="s">&quot;propertyvalue&quot;</span><span class="p">);</span>
<span class="n">myprop</span> <span class="o">=</span> <span class="n">System</span><span class="p">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s">&quot;propertyvalue&quot;</span><span class="p">);</span>
<span class="n">Log</span><span class="p">.</span><span class="n">i</span><span class="p">(</span><span class="n">TAG</span><span class="p">,</span> <span class="s">&quot;propertykey value: &quot;</span> <span class="o">+</span> <span class="n">propertyvalue</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="predefined">
<h2>Predefined<a class="headerlink" href="#predefined" title="Permalink to this heading"></a></h2>
<p>There are also ways to define a predefined system property when Android is being built.</p>
<p><strong>Define System Properties under Proto File</strong></p>
<p>Define system properties as APIs with Sysprop Description files (.sysprop), which use a TextFormat of protobuf, with the following schema:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// File: sysprop.proto</span>

<span class="n">syntax</span> <span class="o">=</span> <span class="s">&quot;proto3&quot;</span><span class="p">;</span>

<span class="n">package</span> <span class="n">sysprop</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">Access</span> <span class="p">{</span>
    <span class="n">Readonly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">Writeonce</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">ReadWrite</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="n">Owner</span> <span class="p">{</span>
    <span class="n">Platform</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">Vendor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">Odm</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="n">Scope</span> <span class="p">{</span>
    <span class="n">Public</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">Internal</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="n">Type</span> <span class="p">{</span>
    <span class="n">Boolean</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">Integer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">Long</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">Double</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="n">String</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
    <span class="n">Enum</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="n">UInt</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
    <span class="n">ULong</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>

    <span class="n">BooleanList</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
    <span class="n">IntegerList</span> <span class="o">=</span> <span class="mi">21</span><span class="p">;</span>
    <span class="n">LongList</span> <span class="o">=</span> <span class="mi">22</span><span class="p">;</span>
    <span class="n">DoubleList</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
    <span class="n">StringList</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
    <span class="n">EnumList</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span>
    <span class="n">UIntList</span> <span class="o">=</span> <span class="mi">26</span><span class="p">;</span>
    <span class="n">ULongList</span> <span class="o">=</span> <span class="mi">27</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">message</span> <span class="n">Property</span> <span class="p">{</span>
    <span class="n">string</span> <span class="n">api_name</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">Type</span> <span class="n">type</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">Access</span> <span class="n">access</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="n">Scope</span> <span class="n">scope</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
    <span class="n">string</span> <span class="n">prop_name</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="n">string</span> <span class="n">enum_values</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">integer_as_bool</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
    <span class="n">string</span> <span class="n">legacy_prop_name</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">message</span> <span class="n">Properties</span> <span class="p">{</span>
    <span class="n">Owner</span> <span class="n">owner</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">string</span> <span class="n">module</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">repeated</span> <span class="n">Property</span> <span class="n">prop</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Sysprop Description file</strong></p>
<p>A Sysprop Description file contains a property message that describes a set of properties. The meaning of its fields are as follows.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Field</strong></p></td>
<td><p><strong>Meaning</strong></p></td>
</tr>
<tr class="row-even"><td><p>owner</p></td>
<td><p>Set to the partition that owns the properties: Platform, Vendor, or Odm.</p></td>
</tr>
<tr class="row-odd"><td><p>module</p></td>
<td><div class="line-block">
<div class="line">Used to create a namespace (C++) or static final class (Java) in which</div>
<div class="line">generated APIs are placed. For example, com.android.sysprop.BuildProperties</div>
<div class="line">will be namespace com::android::sysprop::BuildProperties in C++, and the</div>
<div class="line">BuildProperties class in the package in com.android.sysprop in Java.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>prop</p></td>
<td><p>List of properties.</p></td>
</tr>
</tbody>
</table>
<p><strong>Property</strong></p>
<p>The meanings of the Property message fields are as follows.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Field</strong></p></td>
<td><p><strong>Meaning</strong></p></td>
</tr>
<tr class="row-even"><td><p>api_name</p></td>
<td><p>The name of the generated API.</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td><p>The type of this property.</p></td>
</tr>
<tr class="row-even"><td><p>access</p></td>
<td><div class="line-block">
<div class="line">Readonly: Generates getter API only</div>
<div class="line">Writeonce, ReadWrite: Generates getter and setter APIs</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>scope</p></td>
<td><div class="line-block">
<div class="line">Internal: Only the owner can access.</div>
<div class="line">Public: Everyone can access, except for NDK modules.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>prop_name</p></td>
<td><p>The name of the underlying system property, for example ro.build.date.</p></td>
</tr>
<tr class="row-odd"><td><p>enum_values</p></td>
<td><div class="line-block">
<div class="line">(Enum, EnumList only) A bar(|)-separated string that consists of possible</div>
<div class="line">enum values. For example, value1|value2.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p><strong>Sysprop Description file</strong></p>
<p>Here’s an example of a Sysprop Description file defining three properties:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># File: android/sysprop/PlatformProperties.sysprop</span>

<span class="n">owner</span><span class="p">:</span> <span class="n">Platform</span>
<span class="n">module</span><span class="p">:</span> <span class="s2">&quot;android.sysprop.PlatformProperties&quot;</span>
<span class="n">prop</span> <span class="p">{</span>
    <span class="n">api_name</span><span class="p">:</span> <span class="s2">&quot;build_date&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">String</span>
    <span class="n">prop_name</span><span class="p">:</span> <span class="s2">&quot;ro.build.date&quot;</span>
    <span class="n">scope</span><span class="p">:</span> <span class="n">Public</span>
    <span class="n">access</span><span class="p">:</span> <span class="n">Readonly</span>
<span class="p">}</span>
<span class="n">prop</span> <span class="p">{</span>
    <span class="n">api_name</span><span class="p">:</span> <span class="s2">&quot;date_utc&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Integer</span>
    <span class="n">prop_name</span><span class="p">:</span> <span class="s2">&quot;ro.build.date_utc&quot;</span>
    <span class="n">scope</span><span class="p">:</span> <span class="n">Internal</span>
    <span class="n">access</span><span class="p">:</span> <span class="n">Readonly</span>
<span class="p">}</span>
<span class="n">prop</span> <span class="p">{</span>
    <span class="n">api_name</span><span class="p">:</span> <span class="s2">&quot;device_status&quot;</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Enum</span>
    <span class="n">enum_values</span><span class="p">:</span> <span class="s2">&quot;on|off|unknown&quot;</span>
    <span class="n">prop_name</span><span class="p">:</span> <span class="s2">&quot;device.status&quot;</span>
    <span class="n">scope</span><span class="p">:</span> <span class="n">Public</span>
    <span class="n">access</span><span class="p">:</span> <span class="n">ReadWrite</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Defining system properties libraries</strong></p>
<p>You can now define sysprop_library modules with Sysprop Description files. sysprop_library serves as an API for both C++ and Java. The build system internally generates one java_library and one cc_library for each instance of sysprop_library.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">File</span><span class="p">:</span> <span class="n">Android</span><span class="o">.</span><span class="n">bp</span>
<span class="n">sysprop_library</span> <span class="p">{</span>
    <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;PlatformProperties&quot;</span><span class="p">,</span>
    <span class="n">srcs</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;android/sysprop/PlatformProperties.sysprop&quot;</span><span class="p">],</span>
    <span class="n">property_owner</span><span class="p">:</span> <span class="s2">&quot;Platform&quot;</span><span class="p">,</span>
    <span class="n">vendor_available</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You must include API lists files in the source for API checks. To do this, create API files and an api directory. Put the api directory in the same directory as Android.bp.
The API filenames are <code class="docutils literal notranslate"><span class="pre">&lt;module_name&gt;-current.txt</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;module_name&gt;-latest.txt</span></code>. <code class="docutils literal notranslate"><span class="pre">&lt;module_name&gt;-current.txt</span></code> holds the API signatures of current source codes,
and <code class="docutils literal notranslate"><span class="pre">&lt;module_name&gt;-latest.txt</span></code> holds the latest frozen API signatures. The build system checks whether the APIs are changed by comparing these API files with
generated API files at build time and emits an error message and instructions to update <code class="docutils literal notranslate"><span class="pre">current.txt</span></code> file if current.txt doesn’t match with the source codes.
Here’s an example directory and file organization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── api
│ ├── PlatformProperties-current.txt
│ └── PlatformProperties-latest.txt
└── Android.bp
</pre></div>
</div>
<p><strong>Makefile</strong></p>
<p>Both Java and C++ client modules can link against sysprop_library to use generated APIs. The build system creates links from clients to generated C++ and Java libraries, thus giving clients access to generated APIs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">java_library</span> <span class="p">{</span>
    <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;JavaClient&quot;</span><span class="p">,</span>
    <span class="n">srcs</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;java_access.java&quot;</span><span class="p">],</span>
    <span class="n">libs</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;PlatformProperties&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">cc_binary</span> <span class="p">{</span>
    <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;cc_client&quot;</span><span class="p">,</span>
    <span class="n">srcs</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cpp_access.cpp&quot;</span><span class="p">],</span>
    <span class="n">shared_libs</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;PlatformProperties&quot;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Java Example</strong></p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">android.sysprop.PlatformProperties</span><span class="o">;</span>
<span class="c1">//…</span>
<span class="kd">static</span> <span class="kt">void</span> <span class="nf">java_access</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">//…</span>
    <span class="c1">// read &quot;ro.build.date_utc&quot;. default value is -1</span>
    <span class="n">Integer</span> <span class="n">dateUtc</span> <span class="o">=</span> <span class="n">PlatformProperties</span><span class="o">.</span><span class="na">date_utc</span><span class="o">().</span><span class="na">orElse</span><span class="o">(-</span><span class="mi">1</span><span class="o">);</span>

    <span class="c1">// set &quot;device.status&quot; to &quot;unknown&quot; if &quot;ro.build.date&quot; is not set</span>
    <span class="k">if</span> <span class="o">(!</span><span class="n">PlatformProperties</span><span class="o">.</span><span class="na">build_date</span><span class="o">().</span><span class="na">isPresent</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">PlatformProperties</span><span class="o">.</span><span class="na">device_status</span><span class="o">(</span><span class="n">PlatformProperties</span><span class="o">.</span><span class="na">device_status_values</span><span class="o">.</span><span class="na">UNKNOWN</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">//…</span>
<span class="o">}</span>
<span class="c1">//…</span>
</pre></div>
</div>
<p><strong>CPP Example</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;android/sysprop/PlatformProperties.sysprop.h&gt;</span><span class="cp"></span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">android</span><span class="o">::</span><span class="n">sysprop</span><span class="p">;</span>

<span class="c1">//…</span>

<span class="kt">void</span> <span class="nf">cpp_access</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//…</span>
    <span class="c1">// read &quot;ro.build.date&quot;. default value is &quot;(unknown)&quot;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">build_date</span> <span class="o">=</span> <span class="n">PlatformProperties</span><span class="o">::</span><span class="n">build_date</span><span class="p">().</span><span class="n">value_or</span><span class="p">(</span><span class="s">&quot;(unknown)&quot;</span><span class="p">);</span>

    <span class="c1">// set &quot;device.status&quot; to &quot;on&quot; if it&#39;s &quot;unknown&quot; or not set</span>
    <span class="k">using</span> <span class="n">PlatformProperties</span><span class="o">::</span><span class="n">device_status_values</span><span class="p">;</span>
    <span class="k">auto</span> <span class="n">status</span> <span class="o">=</span> <span class="n">PlatformProperties</span><span class="o">::</span><span class="n">device_status</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">status</span><span class="p">.</span><span class="n">has_value</span><span class="p">()</span> <span class="o">||</span> <span class="n">status</span><span class="p">.</span><span class="n">value</span><span class="p">()</span> <span class="o">==</span> <span class="n">device_status_values</span><span class="o">::</span><span class="n">UNKNOWN</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">PlatformProperties</span><span class="o">::</span><span class="n">device_status</span><span class="p">(</span><span class="n">device_status_values</span><span class="o">::</span><span class="n">ON</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">//…</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="reference">
<h2>Reference:<a class="headerlink" href="#reference" title="Permalink to this heading"></a></h2>
<p>[1]: <code class="docutils literal notranslate"><span class="pre">https://source.android.com/docs/core/architecture/sysprops-apis</span></code></p>
<p>[2]: <code class="docutils literal notranslate"><span class="pre">https://source.android.com/docs/core/architecture/configuration/add-system-properties</span></code></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="systemservices.html" class="btn btn-neutral float-left" title="06-NativeAppDevelopment - System Services" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hal.html" class="btn btn-neutral float-right" title="06-NativeAppDevelopment - Hardware Abstraction Layer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Easwarnet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>