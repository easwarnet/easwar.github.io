<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>06-NativeAppDevelopment - Vendor Native Development Kit (VNDK) &mdash; Easwarnet  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="06-NativeAppDevelopment - Logging and Debugging" href="loggingdebugging.html" />
    <link rel="prev" title="06-NativeAppDevelopment - VHAL - Vehicle HAL" href="vhal.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Easwarnet
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">C++</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-smartptr.html">C++ - Smart Pointer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-inheritence.html">C++ - Inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-container.html">C++ - Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-stdlib.html">C++ - StdLib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp-general.html">C++ - General</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../linux-posix.html">Linux - Posix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../linux-commands.html">Linux - Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../os-general.html">Os - General Concepts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AOSP</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../01-Introduction/androidarchitecture.html">01-Introduction - Android Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-Introduction/features.html">01-Introduction - Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-Introduction/hardwarecompatibility.html">01-Introduction - Hardware Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-Introduction/characteristics.html">01-Introduction - Characteristics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-AndroidBuildSystem/aospoverview.html">02-AndroidBuildSystem - AOSP Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-AndroidBuildSystem/downloadaosp.html">02-AndroidBuildSystem - Download AOSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-AndroidBuildSystem/androidbuildsystem.html">02-AndroidBuildSystem - Android Build System in Detail</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-AndroidBuildSystem/buildingandroid.html">02-AndroidBuildSystem - Building Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-AndroidTools/adb.html">03-AndroidTools - ADB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-AndroidTools/fastboot.html">03-AndroidTools - Fastboot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-AndroidTools/othertools.html">03-AndroidTools - Other Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04-SoftwareUpdate/flashingandroid.html">04-SoftwareUpdate - Flashing Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04-SoftwareUpdate/ota.html">04-SoftwareUpdate - OTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-BootAndPartitions/bootsequence.html">05-BootAndPartitions - Boot Sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-BootAndPartitions/partitions.html">05-BootAndPartitions - Partitions in Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-BootAndPartitions/secureboot.html">05-BootAndPartitions - Secure Boot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-BootAndPartitions/treble.html">05-BootAndPartitions - Project Treble</a></li>
<li class="toctree-l1"><a class="reference internal" href="initrc.html">06-NativeAppDevelopment - Init RC</a></li>
<li class="toctree-l1"><a class="reference internal" href="selinux.html">06-NativeAppDevelopment - SELinux</a></li>
<li class="toctree-l1"><a class="reference internal" href="nativeapplications.html">06-NativeAppDevelopment - Native Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="ndk.html">06-NativeAppDevelopment - NDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="systemservices.html">06-NativeAppDevelopment - System Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="systemproperties.html">06-NativeAppDevelopment - System Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="hal.html">06-NativeAppDevelopment - Hardware Abstraction Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="vhal.html">06-NativeAppDevelopment - VHAL - Vehicle HAL</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">06-NativeAppDevelopment - Vendor Native Development Kit (VNDK)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#purpose-of-vndk">Purpose of VNDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vndk-concepts">VNDK concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vndk-versioning">VNDK versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference">Reference:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="loggingdebugging.html">06-NativeAppDevelopment - Logging and Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07-AndroidIPC/binder.html">07-AndroidIPC - Binder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07-AndroidIPC/hidl.html">07-AndroidIPC - HIDL - HAL Interface Descriptive Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07-AndroidIPC/aidl.html">07-AndroidIPC - Android Interface Definition Language (AIDL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-AppCoreComponents/activities.html">08-AppCoreComponents - Activities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-AppCoreComponents/services.html">08-AppCoreComponents - Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-AppCoreComponents/broadcast.html">08-AppCoreComponents - Broadcast Receivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-AppCoreComponents/contentproviders.html">08-AppCoreComponents - Content Providers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09-TestFramework/cts.html">09-TestFramework - Android CTS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09-TestFramework/vts.html">09-TestFramework - Android VTS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Embedded Beginner</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../os-rtos.html">Os - RTOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-pointers.html">C - Pointers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-funcpointers.html">C - Function Pointers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-general.html">C - General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-basicalgo.html">C - Basic Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c-tricks.html">C - Tricks and Others</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../profile.html"><strong>About</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../profile.html#coming-soon">Coming Soon</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Easwarnet</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>06-NativeAppDevelopment - Vendor Native Development Kit (VNDK)</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nativeappdevelopment-vendor-native-development-kit-vndk">
<h1>06-NativeAppDevelopment - Vendor Native Development Kit (VNDK)<a class="headerlink" href="#nativeappdevelopment-vendor-native-development-kit-vndk" title="Permalink to this heading"></a></h1>
<p>The Vendor Native Development Kit (VNDK) is a set of libraries exclusively for vendors to implement their HALs. The VNDK ships in system.img and is dynamically linked to vendor code at runtime.</p>
<section id="purpose-of-vndk">
<h2>Purpose of VNDK<a class="headerlink" href="#purpose-of-vndk" title="Permalink to this heading"></a></h2>
<p>Android 8.0 and higher enables framework-only updates in which the system partition can be upgraded to the latest version while vendor partitions are left unchanged. This implies that binaries built at different times must be able to work with each other; VNDK covers API/ABI changes across Android releases.</p>
<p>Framework-only updates include the following challenges:
- Dependency between framework modules and vendor modules. Before Android 8.0, modules from both sides could link with modules from the other side. However, dependencies from vendor modules imposed undesired restrictions to framework modules development.
- Extensions to AOSP libraries. Android 8.0 and higher requires all Android devices to pass CTS when the system partition is replaced with a standard Generic System Image (GSI). However, as vendors extend AOSP libraries to boost performance or to add extra functionalities for their HIDL implementations, flashing the system partition with a standard GSI might break a vendor’s HIDL implementation. (For guidelines on preventing such breakages, see VNDK extensions.)</p>
<p>To address these challenges, Android 8.0 introduces several techniques such as VNDK, HIDL, hwbinder, device tree overlay, and sepolicy overlay.</p>
</section>
<section id="vndk-concepts">
<h2>VNDK concepts<a class="headerlink" href="#vndk-concepts" title="Permalink to this heading"></a></h2>
<p>In an ideal Android 8.0 and higher world, framework processes do not load vendor shared libraries, all vendor processes load only vendor shared libraries (and a portion of framework shared libraries), and communications between framework processes and vendor processes are governed by HIDL and hardware binder.</p>
<p>Such a world includes the possibility that stable, public APIs from framework shared libraries might not be sufficient for vendor module developers (although APIs can change between Android releases), requiring that some portion of framework shared libraries be accessible to vendor processes. In addition, as performance requirements can lead to compromises, some response-time-critical HALs must be treated differently.</p>
<p><strong>Framework shared libraries for vendor</strong></p>
<p>There are two approaches to support vendor modules across multiple Android releases:</p>
<ul class="simple">
<li><p>Stabilize the ABIs/APIs of the framework shared libraries. New framework modules and old vendor modules can use the same shared library to reduce memory footprint and storage size. A unique shared library also avoids several double-loading issues. However, the development cost to maintain stable ABIs/APIs is high and it is unrealistic to stabilize all ABIs/APIs exported by every framework shared library.</p></li>
<li><p>Copy old framework shared libraries. Comes with the strong restriction against side channels, defined as all mechanisms to communicate among framework modules and vendor modules, including (but not limited to) binder, socket, pipe, shared memory, shared file, and system properties. There must be no communication unless the communication protocol is frozen and stable (e.g. HIDL through hwbinder). Double-loading shared libraries might cause problems as well; for example, if an object created by the new library is passed into the functions from the old library, an error may occur as these libraries may interpret the object differently.</p></li>
</ul>
<figure class="align-default">
<a class="reference internal image-reference" href="../../_images/vndkfw.png"><img alt="../../_images/vndkfw.png" src="../../_images/vndkfw.png" style="width: 805.0px; height: 442.0px;" /></a>
</figure>
<p>Framework shared libraries are classified into three sub-categories:</p>
<p><strong>LL-NDK Libraries</strong></p>
<p>LL-NDK Libraries are Framework Shared Libraries that are known to be stable. Their developers are committed to maintain their API/ABI stabilities. LL-NDK includes the following libraries: libEGL.so, libGLESv1_CM.so, libGLESv2.so, libGLESv3.so, libandroid_net.so, libc.so, libdl.so, liblog.so, libm.so, libnativewindow.so, libneuralnetworks.so, libsync.so, libvndksupport.so, and libvulkan.so,</p>
<p><strong>Eligible VNDK Libraries</strong></p>
<p>Eligible VNDK Libraries (VNDK) are Framework Shared Libraries that are safe to be copied twice. Framework Modules and Vendor Modules can link with their own copies. A framework shared library can become an eligible VNDK library only if it satisfies the following criteria:
- It does not send/receive IPCs to/from the framework.
- It is not related to ART virtual machine.
- It does not read/write files/partitions with unstable file formats.
- It does not have special software license which requires legal reviews.
- Its code owner does not have objections to vendor usages.</p>
<p><strong>Framework-Only Libraries</strong></p>
<p>Framework-Only Libraries (FWK-ONLY) are Framework Shared Libraries that do not belong to the categories mentioned above. These libraries are considered framework internal implementation details and must not be accessed by vendor modules. These Libraries have unstable ABIs/APIs and no API/ABI compatibility guarantees.</p>
<p><strong>Same-Process HAL (SP-HAL)</strong></p>
<p>Same-Process HAL (SP-HAL) is a set of predetermined HALs implemented as Vendor Shared Libraries and loaded into Framework Processes. SP-HALs are isolated by a linker namespace (controls the libraries and symbols that are visible to the shared libraries). SP-HALs must depend only on LL-NDK and VNDK-SP.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../../_images/vndksphal.png"><img alt="../../_images/vndksphal.png" src="../../_images/vndksphal.png" style="width: 834.0px; height: 474.0px;" /></a>
</figure>
<p>VNDK-SP is a predefined subset of eligible VNDK libraries. VNDK-SP libraries are carefully reviewed to ensure double-loading VNDK-SP libraries into framework processes does not cause problems. Both SP-HALs and VNDK-SPs are defined by Google.</p>
<p>The following libraries are approved SP-HALs:
- <code class="docutils literal notranslate"><span class="pre">libGLESv1_CM_${driver}.so</span></code>
- <code class="docutils literal notranslate"><span class="pre">libGLESv2_${driver}.so</span></code>
- <code class="docutils literal notranslate"><span class="pre">libGLESv3_${driver}.so</span></code>
- <code class="docutils literal notranslate"><span class="pre">libEGL_${driver}.so</span></code>
- <code class="docutils literal notranslate"><span class="pre">vulkan.${driver}.so</span></code>
- <code class="docutils literal notranslate"><span class="pre">android.hardware.renderscript&#64;1.0-impl.so</span></code>
- <code class="docutils literal notranslate"><span class="pre">android.hardware.graphics.mapper&#64;2.0-impl.so</span></code></p>
<p>VNDK-SP libraries specify vndk: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">support_system_process:</span> <span class="pre">true</span> <span class="pre">}</span></code> in their <code class="docutils literal notranslate"><span class="pre">Android.bp</span></code> files.
If <code class="docutils literal notranslate"><span class="pre">vendor_available:</span> <span class="pre">false</span></code> is also specified, then these libraries are called VNDK-SP-Private and they are invisible to SP-HALS.</p>
<p>The following are framework-only libraries with RS exceptions (FWK-ONLY-RS):
libft2.so (Renderscript)
libmediandk.so (Renderscript)</p>
</section>
<section id="vndk-versioning">
<h2>VNDK versioning<a class="headerlink" href="#vndk-versioning" title="Permalink to this heading"></a></h2>
<p>In Android 9, VNDK shared libraries are versioned:</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ro.vndk.version</span></code> system property is automatically added to <code class="docutils literal notranslate"><span class="pre">/vendor/default.prop</span></code>.
VNDK shared libraries are installed to <code class="docutils literal notranslate"><span class="pre">/system/lib[64]/vndk-${ro.vndk.version}</span></code>.
VNDK-SP shared libraries are installed to <code class="docutils literal notranslate"><span class="pre">/system/lib[64]/vndk-sp-${ro.vndk.version}</span></code>.
The dynamic linker configuration file is installed to <code class="docutils literal notranslate"><span class="pre">/system/etc/ld.config.${ro.vndk.version}.txt</span></code>.</p>
</section>
<section id="reference">
<h2>Reference:<a class="headerlink" href="#reference" title="Permalink to this heading"></a></h2>
<p>[1]: <code class="docutils literal notranslate"><span class="pre">https://source.android.com/devices/architecture/vndk</span></code></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vhal.html" class="btn btn-neutral float-left" title="06-NativeAppDevelopment - VHAL - Vehicle HAL" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="loggingdebugging.html" class="btn btn-neutral float-right" title="06-NativeAppDevelopment - Logging and Debugging" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Easwarnet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>